# Использование методов машинного обучения для анализа переменных звёзд

## Описание проекта

Этот проект посвящен задаче бинарной классификации: построению модели, способной отличать переменные звёзды от статичных объектов. Исходные данные содержат признаки различных небесных объектов, но датасет изначально несбалансирован. Основной целью является обнаружение переменных звезд, поэтому ключевыми метриками являются **recall** (полнота) и **F1-score**.

## Используемые библиотеки

- `pandas` – обработка данных
- `matplotlib`, `seaborn` – визуализация
- `scikit-learn` – алгоритмы машинного обучения
- `imblearn` – работа с несбалансированными данными
- `xgboost`, `catboost`, `lightgbm` – градиентный бустинг
- `TSNE` – понижение размерности для визуализации

## Подготовка данных

1. Загрузка датасета `whole_data_practice3.csv`.
2. Удаление столбца `type` из-за большого количества пропущенных значений (~90%).
3. Удаление первых 5 строк, возможно содержащих некорректные данные.
4. Анализ корреляции между признаками и удаление сильно коррелирующих признаков: `Bmag`, `gpmag`, `rpmag`, `ipmag`.
5. Визуализация распределений признаков с использованием гистограмм, boxplot и violin-графиков.
6. Понижение размерности методом t-SNE для визуализации классов.
7. Масштабирование данных с помощью `RobustScaler`, устойчивого к выбросам.

## Обучение моделей

Рассматривались различные алгоритмы машинного обучения:

- **Логистическая регрессия** (`LogisticRegression`) с учетом дисбаланса классов.
- **Метод k ближайших соседей** (`KNeighborsClassifier`) – показал слабые результаты на несбалансированном датасете.
- **Дерево решений** (`DecisionTreeClassifier`)
- **Случайный лес** (`RandomForestClassifier`)
- **Градиентный бустинг** (`GradientBoostingClassifier`)

Оценка проводилась с помощью `cross_val_predict` и `StratifiedKFold` (5 фолдов).

## Процесс улучшения качества модели

- Использована техника **SMOTE** для синтетического увеличения количества наблюдений миноритарного класса.
- Построен `Pipeline` с SMOTE и градиентным бустингом.
- Подбор гиперпараметров осуществлён с помощью `GridSearchCV`:
  - `max_depth=12`
  - `k_neighbors=5`
- Лучшая модель после оптимизации дала следующие метрики:
  - **Accuracy**: 0.94
  - **Precision**: 0.68
  - **Recall**: 0.77
  - **F1-score**: 0.72

## Финальная модель

В качестве финальной модели использован **StackingClassifier**, включающий:
- `CatBoostClassifier`
- `XGBClassifier`
- `LGBMClassifier`
- Финальный классификатор: `LogisticRegression`

Порог классификации был подобран вручную на основе precision-recall кривой для достижения наилучшего баланса между полнотой и точностью (среди всех значений precision, выше 0.65, был найден порог, при котором recall максимальный)

Окончательные метрики:
- **Accuracy**: 0.94
- **Precision**: 0.65
- **Recall**: 0.85
- **F1-score**: 0.74

## Запуск кода

1. Установите зависимости:
   ```bash
   pip install pandas matplotlib seaborn scikit-learn imbalanced-learn catboost xgboost lightgbm
   ```
2. Запустите основной скрипт:
   ```bash
   python main.py
   ```

## Выводы

Использование методов балансировки классов (SMOTE), подбор гиперпараметров и стэкинг моделей на основе бустинга позволили достичь высокой полноты и хорошего F1. Итоговая модель эффективно справляется с задачей выявления переменных звёзд даже в условиях значительного дисбаланса классов.

